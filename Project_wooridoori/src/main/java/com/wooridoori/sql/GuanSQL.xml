<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="guan">
	<select id="AreaCodeOfMain1" resultType="String">
		select distinct areaname from area_code order by areaname
	</select>
	
	<select id="GetSigunguName" parameterType="String" resultType="String">
		select sigunguname from area_code where areaname = #{areaname} and sigunguname is not null
	</select>
	
	<select id="GetSigunguInfo" parameterType="String" resultType="gudto">
	    select e.sigunguname, d.sigungucode, d.m2, d.firstimage from area_code e,
		(select b.sigungucode, b.m2, c.firstimage, b.areacode from tour_inquiry c, 
		(select a.sigungucode, max(t.contentid) m2, a.areacode from tour_inquiry t, (select sigungucode, max(readcount) m, areacode
		from tour_inquiry where areacode = #{areacode} and cat2 in('A0101', 'A0102', 'A0201', 'A0202', 'A0203', 'A0204', 'C0112', 'C0113', 'C0114', 'C0115', 'C0116', 'C0117') group by sigungucode, areacode) a 
		where a.m = t.readcount group by a.sigungucode, a.areacode) b
		where b.m2=c.contentid) d
		where e.sigungucode = d.sigungucode and e.areacode = d.areacode order by sigunguname
	</select>
	
	<select id="GetcodeOfArea" parameterType="String" resultType="String">
		select distinct areacode from area_code where areaname = #{areaname}
	</select>
	
	<select id="SelectcodeFromDB" parameterType="HashMap" resultType="gudto">
		select distinct areacode, sigungucode from area_code where areaname=#{areaname} and sigunguname = #{sigungu}
	</select>
	
	<select id="TListOfMain" parameterType="HashMap" resultType="gudto">
		select distinct b.addr1, b.areacode, b.cat1, b.cat2, b.cat3, b.contentid, b.contenttypeid, b.firstimage, b.firstimage2, b.modifiedtime, 
 		b.mapx, b.mapy, b.readcount, b.sigungucode, b.tel, b.title, b.zipcode, c.cat3_name from area_code a inner join tour_inquiry b on a.sigungucode = b.sigungucode  
		inner join content_code c on b.cat3 = c.cat3 where c.cat2 in('A0101', 'A0102', 'A0201', 'A0202', 'A0203', 'A0204', 'C0112', 'C0113', 'C0114', 'C0115', 'C0116', 'C0117') 
		and b.areacode=#{areacode} and b.sigungucode=#{sigungucode}
	</select>
	
	<select id="TListWithName" parameterType="HashMap" resultType="gudto">
		select distinct b.addr1, b.areacode, b.cat1, b.cat2, b.cat3, b.contentid, b.contenttypeid, b.firstimage, b.firstimage2, b.modifiedtime, 
 		b.mapx, b.mapy, b.readcount, b.sigungucode, b.tel, b.title, b.zipcode, c.cat3_name from area_code a inner join tour_inquiry b on a.sigungucode = b.sigungucode  
		inner join content_code c on b.cat3 = c.cat3 where c.cat2 in('A0101', 'A0102', 'A0201', 'A0202', 'A0203', 'A0204', 'C0112', 'C0113', 'C0114', 'C0115', 'C0116', 'C0117') 
		and b.areacode=#{areacode} and b.sigungucode=#{sigungucode} order by b.title
	</select>
	
	<select id="TListWithCat" parameterType="HashMap" resultType="gudto">
		select distinct b.addr1, b.areacode, b.cat1, b.cat2, b.cat3, b.contentid, b.contenttypeid, b.firstimage, b.firstimage2, b.modifiedtime, 
 		b.mapx, b.mapy, b.readcount, b.sigungucode, b.tel, b.title, b.zipcode, c.cat3_name from area_code a inner join tour_inquiry b on a.sigungucode = b.sigungucode  
		inner join content_code c on b.cat3 = c.cat3 where c.cat2 in('A0101', 'A0102', 'A0201', 'A0202', 'A0203', 'A0204', 'C0112', 'C0113', 'C0114', 'C0115', 'C0116', 'C0117') 
		and b.areacode=#{areacode} and b.sigungucode=#{sigungucode} order by c.cat3_name
	</select>
	
	<select id="TListWithAvg" parameterType="HashMap" resultType="gudto">
		select distinct b.addr1, b.areacode, b.cat1, b.cat2, b.cat3, b.contentid, b.contenttypeid, b.firstimage, b.firstimage2, b.modifiedtime, 
 		b.mapx, b.mapy, b.readcount, b.sigungucode, b.tel, b.title, b.zipcode, c.cat3_name from area_code a inner join tour_inquiry b on a.sigungucode = b.sigungucode  
		inner join content_code c on b.cat3 = c.cat3 where c.cat2 in('A0101', 'A0102', 'A0201', 'A0202', 'A0203', 'A0204', 'C0112', 'C0113', 'C0114', 'C0115', 'C0116', 'C0117') 
		and b.areacode=#{areacode} and b.sigungucode=#{sigungucode} order by 
	</select>
	
		<select id="TListWithCount" parameterType="HashMap" resultType="gudto">
		select distinct b.addr1, b.areacode, b.cat1, b.cat2, b.cat3, b.contentid, b.contenttypeid, b.firstimage, b.firstimage2, b.modifiedtime, 
 		b.mapx, b.mapy, b.readcount, b.sigungucode, b.tel, b.title, b.zipcode, c.cat3_name from area_code a inner join tour_inquiry b on a.sigungucode = b.sigungucode  
		inner join content_code c on b.cat3 = c.cat3 where c.cat2 in('A0101', 'A0102', 'A0201', 'A0202', 'A0203', 'A0204', 'C0112', 'C0113', 'C0114', 'C0115', 'C0116', 'C0117') 
		and b.areacode=#{areacode} and b.sigungucode=#{sigungucode} order by b.readcount desc
	</select>
	
</mapper>